export type Lang = "en" | "ja" | "kana";

export const LANG_STORAGE_KEY = "qbu_lang_v1";

export const LANG_OPTIONS: { value: Lang; label: string }[] = [
  { value: "en", label: "English" },
  { value: "ja", label: "日本語" },
  { value: "kana", label: "にほんご" },
];

type Dict = Record<string, string>;

const MESSAGES: Record<Lang, Dict> = {
  en: {
    // Modes
    "mode.model": "Modeling",
    "mode.paint": "Painting",
    "mode.coding": "Coding",
    "mode.gallery": "Gallery",

    // Header
    "header.save": "Save",
    "header.project.untitled": "Untitled",
    "header.project.rename": "Rename project",

    // Editor HUD
    "editor.blocks": "Blocks: {n}",
    "editor.look": "Look",
    "editor.pickColor": "Pick color",
    "editor.edges": "Edges",
    "editor.preview": "Preview",
    "editor.reset": "Reset",
    "editor.viewFromTop": "View from top",
    "editor.viewFromBottom": "View from bottom",
    "editor.rotateLeft": "Rotate left",
    "editor.rotateRight": "Rotate right",
    "editor.zoomIn": "Zoom in",
    "editor.zoomOut": "Zoom out",
    "editor.zoom": "Zoom",

    // Preview
    "preview.front": "Front",
    "preview.back": "Back",
    "preview.left": "Left",
    "preview.right": "Right",
    "preview.top": "Top",
    "preview.bottom": "Bottom",
    "preview.threeView": "3-view",
    "preview.clear": "Clear",
    "preview.close": "Close",

    // Save modal
    "save.title": "Save",
    "save.close": "Close",
    "save.name": "Name",
    "save.method": "Method",
    "save.method.project": "Project",
    "save.method.project.desc": "Continue editing later",
    "save.method.stl": "STL",
    "save.method.stl.desc": "Export for 3D printing",
    "save.destination": "Destination",
    "save.destination.hint": "Saved to MyProjects (cloud).",
    "save.destination.noteFormat": "※ Since v1.0.16, JSON save is removed; format is unified to .qbu.",
    "save.asNew": "Save as new (copy)",
    "save.asNew.hint": "If OFF, it overwrites.",
    "save.localExport": "Local export (optional)",
    "save.localExport.qbu": "Export .qbu locally",
    "save.localExport.hint": "For sharing or backup.",
    "save.localExport.noteNoPassword": "※ Since v1.0.16, password option for export is removed.",
    "save.size": "Size",
    "save.size.maxSide": "Max side",
    "save.size.blockEdge": "1 block",
    "save.size.mmMaxSide": "mm (set max side to {mm}mm)",
    "save.size.mmBlock": "mm (1 block edge) → max side {mm}mm",
    "save.size.current": "Current model: max {n} blocks / 1 block edge {mm}mm",
    "save.warn.tooLarge": "⚠ Max side exceeds 180mm (too large for print request)",
    "save.cancel": "Cancel",
    "save.saving": "Saving...",
    "save.save": "Save",
    "save.exportStl": "Export STL",
    "save.exportForPrint": "Export STL for print",

    // Parent gate
    "parent.section": "Parent controls",
    "parent.password": "Parent password",
    "parent.password.set": "Set",
    "parent.password.change": "Change",
    "parent.password.clear": "Clear",
    "parent.password.new": "New password",
    "parent.password.confirm": "Confirm",
    "parent.password.saved": "Saved",
    "parent.password.mismatch": "Passwords do not match",
    "parent.remember": "Remember unlock",
    "parent.remember.onlyNow": "Only now",
    "parent.remember.minutes": "{n} min",
    "parent.require": "Require password for",
    "parent.action.print": "Print request",
    "parent.action.publish": "Publish/Unpublish",
    "parent.action.delete": "Delete",
    "parent.action.download": "Download",
    "parent.action.subscribe": "Subscription",
    "parent.action.change_language": "Change language",
    "parent.prompt.enter": "Enter parent password",
    "parent.prompt.wrong": "Wrong password",
    "parent.prompt.failed": "Password check failed",
    "parent.state.notSet": "(not set)",
    "parent.state.ok": "OK",
    "parent.state.lock": "LOCK",
    "parent.unlock": "Unlock",
    "parent.lock": "Lock",
    "parent.unlockToEdit": "Unlock to edit.",

    // Gallery
    "gallery.my": "MyProjects",
    "gallery.public": "PublicProjects",
    "gallery.search": "Search",
    "gallery.loading": "Loading...",
    "gallery.loginToSeeMy": "Sign in to see MyProjects.",
    "gallery.noImage": "No Image",
    "gallery.open": "Open",
    "gallery.openCopy": "Open as copy",
    "gallery.rename": "Rename",
    "gallery.thumbnail": "Thumbnail",
    "gallery.download": "Download",
    "gallery.publish": "Publish",
    "gallery.unpublish": "Unpublish",
    "gallery.delete": "Delete",
    "gallery.publicTag": "Public",
    "gallery.updated": "updated",
    "gallery.blocks": "blocks",
    "gallery.noMy": "No saved projects yet.",
    "gallery.noPublic": "No public projects.",
    "gallery.thumbHint": "Use the arrows to change view. Use wheel/trackpad/pinch to zoom.",
    "gallery.thumbSave": "Save thumbnail",
    "gallery.thumbPublicNote": "If published, this thumbnail is also shown in PublicProjects.",

    // Coding
    "coding.code": "Code",
    "coding.current": "Current",
    "coding.preview": "Preview",
    "coding.run": "Run",
    "coding.apply": "Apply",
    "coding.applyBack": "Apply & back",
    "coding.console": "Console",
    "coding.resultHere": "Result will appear here",
    "coding.running": "Running...",
    "coding.preparing": "Preparing...",
    "coding.pyodideBoot": "Starting Pyodide...",
    "coding.readyOk": "Ready",
    "coding.runFailed": "Run failed",
    "coding.done": "Done (blocks: {n})",
    "coding.error": "Error",

    // Common
    "common.close": "Close",
    "common.processing": "Processing...",
    "common.toEditor": "Editor",

    // Account drawer
    "account.account": "Account",
    "account.signIn": "Sign in",
    "account.signInWithGoogle": "Google",
    "account.signOut": "Sign out",
    "account.openInBrowser": "Open in browser",
    "account.loginRequired": "Sign in required.",
    "account.notConfigured": "Auth is not configured.",
    "account.docs": "Documentation",
    "account.docs.all": "Docs index",
    "account.docs.modeling": "Modeling",
    "account.docs.painting": "Painting",
    "account.docs.coding": "Coding",
    "account.docs.gallery": "Gallery",
    "account.settings": "Settings",
    "account.language": "Language",
    "account.close": "Close",

    // Toasts
    "toast.renamed": "Renamed: {name}",
    "toast.renameFailed": "Rename failed: {msg}",
    "toast.loginToSyncName": "Sign in to sync the name to cloud.",

    // Toggle
    "common.on": "ON",
    "common.off": "OFF",

    // Consent / Privacy
    "consent.aria": "Usage analytics consent",
    "consent.title": "Usage analytics (required)",
    "consent.required": "Consent required",
    "consent.text": "Q-BU collects usage analytics (such as interaction logs) to improve the experience.",
    "consent.collect": "Collect: edit/preview actions, zoom, button clicks, save actions, error info, device/browser info (e.g. screen size)",
    "consent.notCollect": "Not collect: email contents, passwords, the image data itself (file contents)",
    "consent.detail": "See details",
    "consent.agree": "Agree & start",

    "privacy.title": "Privacy & Usage Analytics",
    "privacy.back": "Back",
    "privacy.agreeStart": "Agree & start",
    "privacy.intro": "Q-BU measures usage analytics (interaction logs) to improve the experience. Consent is required to use the app.",
    "privacy.collect.title": "What we collect",
    "privacy.collect.item1": "Interaction events (edit/preview, zoom, button actions, save actions, etc.)",
    "privacy.collect.item2": "Editing state stats (e.g., block count, camera/zoom state, whether reference images are used)",
    "privacy.collect.item3": "Device/browser info (e.g., user agent, screen/viewport, language, timezone, network info)",
    "privacy.collect.item4": "Performance metrics (e.g., render times)",
    "privacy.collect.item5": "Error info (crashes/exceptions)",
    "privacy.collect.item6": "We do not store raw IP address; we may treat a hashed identifier on the server.",
    "privacy.notCollect.title": "What we don't collect",
    "privacy.notCollect.item1": "Passwords",
    "privacy.notCollect.item2": "Email body",
    "privacy.notCollect.item3": "Reference image data (file contents)",
    "privacy.revoke.title": "Withdraw consent",
    "privacy.revoke.text": "To withdraw consent, delete the site's data (localStorage / Cookie) in your browser. You'll be asked again next time. (Without consent, you cannot use the app.)",

    // Print prep
    "printprep.title": "Prepare for printing",
    "printprep.sub.maxSide": "Max side {mm}mm",
    "printprep.sub.blockEdge": "1 block {mm}mm (max side {max}mm)",
    "printprep.status.ready": "No floating blocks.",
    "printprep.status.floating": "Floating blocks found ({n} parts).",
    "printprep.help.ready": "Ready for printing.",
    "printprep.help.floating": "Red = floating. Blue blocks are auto supports (0.5). Click/tap to add, right-click/long-press to remove.",
    "printprep.size": "Print size",
    "printprep.quote": "Est. subtotal (shipping excl.): {yen}¥ / Est. volume {vol}cm³",
    "printprep.auto": "Auto complete",
    "printprep.clear": "Clear supports",
    "printprep.exportStl": "Export (STL)",
    "printprep.request": "Request print",
    "printprep.requestDisabled": "Max side exceeds 180mm; cannot request print.",
    "printprep.controls": "Controls",
    "printprep.hint.compact.l1": "Tap: add support(0.5) / Long press: remove",
    "printprep.hint.compact.l2": "2 fingers: pan / Pinch: zoom",
    "printprep.hint.compact.l3": "Red: floating / Blue: support",
    "printprep.hint.full.l1": "Click/tap: add support(0.5) / Right click/long press: remove",
    "printprep.hint.full.l2": "Middle button/2 fingers: pan / Wheel/pinch: zoom / Space: center",
    "printprep.hint.full.l3": "Red: floating / Blue: support",
    "printprep.counts": "Blocks: {base}  Support: {supp}  Floating: {floating}",
    "printprep.counts.supportFloating": " (supports: {n})",
    "printprep.view.top": "View from top",
    "printprep.view.bottom": "View from bottom",
    "printprep.view.left": "Rotate left",
    "printprep.view.right": "Rotate right",
    "printprep.zoom": "Zoom",

    // Print request page (kana mode uses Japanese)
    "print.title": "Request a print",
    "print.subtitle": "Enter contact & shipping address, then submit the request (quote is an estimate).",
    "print.section.content": "Details",
    "print.done.title": "Submitted",
    "print.done.text": "We received your print request. We'll review it and contact you by email.",
    "print.done.orderId": "Order ID",
    "print.done.backEditor": "Back to editor",
    "print.done.admin": "Open admin (admin)",
    "print.done.adminNote": "※ Admin page requires permission.",
    "print.warn.tooLarge": "⚠ Max side exceeds 180mm (too large for print request)",
    "print.quote.subtotal": "Est. subtotal: {yen}¥ / Est. volume {vol}cm³",
    "print.quote.shippingPending": "Shipping is calculated after address lookup.",
    "print.quote.shippingLabel": "Shipping est.",
    "print.quote.totalLabel": "Total est.",
    "print.shipping.cannot": "Could not determine shipping ({reason}). Please confirm the address and the shipping settings.",
    "print.note.rough": "※ Estimate only (varies by process/material/wall thickness/infill).",
    "print.note.ticket": "※ Ticket discount is finalized after submission.",
    "print.noDraft": "No print data. Go back to the editor and start from “Request print”.",
    "print.field.name": "Name",
    "print.field.email": "Email",
    "print.field.phone": "Phone (optional)",
    "print.address.title": "Shipping address (Zip code → lookup)",
    "print.address.zipPlaceholder": "e.g. 252-0802",
    "print.address.lookup": "Lookup",
    "print.address.looking": "Looking up...",
    "print.address.hint": "We use the lookup result to determine prefecture and calculate shipping automatically.",
    "print.address.results": "Lookup results",
    "print.address.line2": "Address line 2 (street/building, etc.)",
    "print.address.line2Placeholder": "e.g. 250-4 Building 101",
    "print.address.confirmed": "Confirmed address:",
    "print.field.ticket": "Discount ticket (optional)",
    "print.field.ticketPlaceholder": "e.g. QBU-ABCD-EFGH-IJKL",
    "print.field.ticketHint": "Only if you have one.",
    "print.field.notes": "Notes (optional)",
    "print.btn.back": "Back",
    "print.btn.submit": "Submit request",
    "print.btn.submitting": "Submitting...",
    "print.paymentNote": "※ Payment (Stripe/Google Pay) will be added in a later phase.",
    "print.summary.size.maxSide": "Max side {max}mm (1 unit = {unit}mm)",
    "print.summary.size.blockEdge": "1 block edge {unit}mm (max side {max}mm)",
    "print.summary": "Model: {name} / Blocks: {base} (support {supp}) / Size: {size}",
    "print.error.zip7": "Please enter a 7-digit zip code.",
    "print.error.zipLookupFailed": "Zip lookup failed.",
    "print.error.zipNotFound": "No matching address was found.",
    "print.error.noDraft": "No print data. Please go back to the editor and start from “Request print”.",
    "print.error.tooLarge": "Max side exceeds 180mm; cannot request print. Please reduce size.",
    "print.error.email": "Please enter an email address.",
    "print.error.name": "Please enter your name.",
    "print.error.addressLookup": "Please enter the zip code and run address lookup to confirm the destination.",
    "print.error.addressLine2": "Please enter address line 2 (street/building).",
    "print.error.addressConfirm": "Please confirm the shipping address.",
    "print.error.submitFailed": "Failed to submit.",

    // Gallery (prompts/errors)
    "gallery.supabaseMissing": "Supabase is not configured.",
    "gallery.prompt.rename": "Rename project",
    "gallery.alert.updateFailed": "Update failed: {msg}",
    "gallery.confirm.delete": "Delete this project?\n{name}",
    "gallery.alert.deleteFailed": "Delete failed: {msg}",
    "gallery.alert.downloadFailed": "Download failed: {msg}",
    "gallery.alert.dataEmpty": "Model data is empty.",
    "gallery.prompt.legacyPassword": "(Legacy QBU only) Enter password\n* v1.0.16+ saves have no password.",
    "gallery.thumb.notReady": "Snapshot is not ready.",
    "gallery.thumb.failed": "Failed to capture snapshot.",

    // Account messages
    "account.linkCopied": "Link copied. Paste it in Chrome/Safari and open it.",
    "account.openInBrowserFailed": "Please open again in a regular browser (Chrome/Safari) and sign in.",

    // Coding (extras)
    "coding.example.mirror_x": "Mirror (X)",
    "coding.example.box_checker": "Hollow box + checker paint",
    "coding.example.sphere": "Sphere (solid)",
    "coding.snippet.picked_cube": "(Picked cube is auto inserted)",
    "coding.snippet.mirror": "Mirror",
    "coding.snippet.box": "Box",
    "coding.snippet.sphere": "Sphere",
    "coding.snippet.checker": "Checker paint",
    "coding.support.depsSuffix": "candidates",
    "coding.support.complete": "Suggestions",
    "coding.support.none": "(No suggestions)",
    "coding.console.empty": "(print output / stderr / errors will appear here)",
    "coding.stats": "blocks: {blocks} / edges: {edges}",
    "coding.workerNotReady": "Worker is not running.",
    "coding.supabaseMissing": "Supabase is not configured; cannot apply to cloud.",

    // Auth
    "auth.notConfigured": "Sign-in is not configured.",
    "auth.googleFailed": "Google sign-in failed.",

  },
  ja: {
    "mode.model": "Modeling",
    "mode.paint": "Painting",
    "mode.coding": "Coding",
    "mode.gallery": "Gallery",

    "header.save": "保存する",
    "header.project.untitled": "名称未設定",
    "header.project.rename": "プロジェクト名を変更",

    "editor.blocks": "ブロック: {n}",
    "editor.look": "見た目",
    "editor.pickColor": "色を選ぶ",
    "editor.edges": "エッジ",
    "editor.preview": "プレビュー",
    "editor.reset": "リセット",
    "editor.viewFromTop": "上から見る",
    "editor.viewFromBottom": "下から見る",
    "editor.rotateLeft": "左へ",
    "editor.rotateRight": "右へ",
    "editor.zoomIn": "寄る",
    "editor.zoomOut": "引く",
    "editor.zoom": "ズーム",

    "preview.front": "前",
    "preview.back": "後",
    "preview.left": "左",
    "preview.right": "右",
    "preview.top": "上",
    "preview.bottom": "下",
    "preview.threeView": "3面図",
    "preview.clear": "消す",
    "preview.close": "閉じる",

    "save.title": "保存",
    "save.close": "閉じる",
    "save.name": "名前",
    "save.method": "方法",
    "save.method.project": "プロジェクト",
    "save.method.project.desc": "あとで続きから編集できます",
    "save.method.stl": "STL",
    "save.method.stl.desc": "3Dプリント用に書き出し",
    "save.destination": "保存先",
    "save.destination.hint": "MyProjects（クラウド）に保存します。",
    "save.destination.noteFormat": "※ v1.0.16 から新規の JSON 保存は廃止し、.qbu 形式に統一します。",
    "save.asNew": "新規として保存（コピー）",
    "save.asNew.hint": "OFFの場合は上書き保存になります。",
    "save.localExport": "ローカル書き出し（任意）",
    "save.localExport.qbu": ".qbu をローカルにも書き出す",
    "save.localExport.hint": "外部共有やバックアップ用途。",
    "save.localExport.noteNoPassword": "※ v1.0.16 以降、書き出し時のパスワード指定は廃止しました。",
    "save.size": "サイズ",
    "save.size.maxSide": "最長辺",
    "save.size.blockEdge": "1ブロック",
    "save.size.mmMaxSide": "mm（最長辺を {mm}mm に）",
    "save.size.mmBlock": "mm（1ブロック辺）→ 最大辺 {mm}mm",
    "save.size.current": "現在のモデル：最大 {n} ブロック ／ 1ブロック辺 {mm}mm",
    "save.warn.tooLarge": "⚠ 最大辺が180mmを超えています（印刷依頼には大きすぎます）",
    "save.cancel": "キャンセル",
    "save.saving": "保存中...",
    "save.save": "保存",
    "save.exportStl": "STLを書き出す",
    "save.exportForPrint": "印刷用にSTLを書き出す",

    "parent.section": "保護者設定",
    "parent.password": "保護者パスワード",
    "parent.password.set": "設定",
    "parent.password.change": "変更",
    "parent.password.clear": "解除",
    "parent.password.new": "新しいパスワード",
    "parent.password.confirm": "確認",
    "parent.password.saved": "保存しました",
    "parent.password.mismatch": "パスワードが一致しません",
    "parent.remember": "解除の有効時間",
    "parent.remember.onlyNow": "今回のみ",
    "parent.remember.minutes": "{n}分",
    "parent.require": "パスワードを求める操作",
    "parent.action.print": "印刷依頼",
    "parent.action.publish": "公開/非公開",
    "parent.action.delete": "削除",
    "parent.action.download": "ダウンロード",
    "parent.action.subscribe": "サブスク契約",
    "parent.action.change_language": "言語変更",
    "parent.prompt.enter": "保護者パスワードを入力してください",
    "parent.prompt.wrong": "パスワードが違います",
    "parent.prompt.failed": "確認に失敗しました",
    "parent.state.notSet": "未設定",
    "parent.state.ok": "OK",
    "parent.state.lock": "ロック",
    "parent.unlock": "解除",
    "parent.lock": "ロック",
    "parent.unlockToEdit": "編集には解除が必要です。",

    "gallery.my": "MyProjects",
    "gallery.public": "PublicProjects",
    "gallery.search": "検索",
    "gallery.loading": "読み込み中...",
    "gallery.loginToSeeMy": "ログインすると MyProjects を表示できます。",
    "gallery.noImage": "No Image",
    "gallery.open": "Open",
    "gallery.openCopy": "コピーとして開く",
    "gallery.rename": "Rename",
    "gallery.thumbnail": "Thumbnail",
    "gallery.download": "Download",
    "gallery.publish": "Publish",
    "gallery.unpublish": "Unpublish",
    "gallery.delete": "Delete",
    "gallery.publicTag": "Public",
    "gallery.updated": "updated",
    "gallery.blocks": "blocks",
    "gallery.noMy": "まだ保存がありません。",
    "gallery.noPublic": "公開プロジェクトがありません。",
    "gallery.thumbHint": "右上の矢印で視点を変更、ホイール/トラックパッドで拡大縮小できます。",
    "gallery.thumbSave": "サムネイルを保存",
    "gallery.thumbPublicNote": "※ Public に公開中の場合、右側の PublicProjects にも反映されます。",

    "coding.code": "Code",
    "coding.current": "Current",
    "coding.preview": "Preview",
    "coding.run": "実行",
    "coding.apply": "適用",
    "coding.applyBack": "適用して戻る",
    "coding.console": "Console",
    "coding.resultHere": "実行結果がここに表示されます",
    "coding.running": "実行中...",
    "coding.preparing": "準備中...",
    "coding.pyodideBoot": "Pyodide を起動しています...",
    "coding.readyOk": "準備OK",
    "coding.runFailed": "実行に失敗しました",
    "coding.done": "実行完了（blocks: {n}）",
    "coding.error": "エラー",

    "common.close": "閉じる",
    "common.processing": "処理中...",
    "common.toEditor": "エディタへ",

    "account.account": "アカウント",
    "account.signIn": "ログイン",
    "account.signInWithGoogle": "Google",
    "account.signOut": "ログアウト",
    "account.openInBrowser": "ブラウザで開く",
    "account.loginRequired": "ログインが必要です。",
    "account.notConfigured": "Supabase 未設定（ログイン不可）",
    "account.docs": "Documentation",
    "account.docs.all": "目次",
    "account.docs.modeling": "Modeling（造形）",
    "account.docs.painting": "Painting（ペイント）",
    "account.docs.coding": "Coding（Python）",
    "account.docs.gallery": "Gallery（一覧）",
    "account.settings": "ユーザー設定",
    "account.language": "言語",
    "account.close": "閉じる",

    "toast.renamed": "名前を変更しました: {name}",
    "toast.renameFailed": "名前の変更に失敗しました: {msg}",
    "toast.loginToSyncName": "ログインするとクラウドへ反映できます",

    "common.on": "ON",
    "common.off": "OFF",

    "consent.aria": "利用状況の計測",
    "consent.title": "利用状況の計測（必須）",
    "consent.required": "同意が必要です",
    "consent.text": "Q-BU! は、改善と検証のために利用状況（操作ログなど）を収集します。",
    "consent.collect": "収集：編集/プレビュー操作、ズーム、ボタン操作、保存操作、エラー情報、端末/ブラウザ情報（例：画面サイズ等）",
    "consent.notCollect": "収集しない：メール本文、パスワード、画像そのもの（ファイル内容）",
    "consent.detail": "収集内容の詳細を見る",
    "consent.agree": "同意して開始",

    "privacy.title": "プライバシーと利用状況の計測",
    "privacy.back": "戻る",
    "privacy.agreeStart": "同意して開始",
    "privacy.intro": "Q-BU! は、体験の改善と効果検証のために利用状況（操作ログ）を計測します。アプリの利用にはこの計測への同意が必要です。",
    "privacy.collect.title": "収集する情報",
    "privacy.collect.item1": "操作イベント（編集/プレビュー操作、ズーム、ボタン操作、保存操作など）",
    "privacy.collect.item2": "編集状態の統計（例：ブロック数、視点/ズームの状態、参照画像の有無）",
    "privacy.collect.item3": "端末・ブラウザ情報（例：ユーザーエージェント、画面/ビューポート、言語、タイムゾーン、通信情報）",
    "privacy.collect.item4": "パフォーマンス情報（表示時間などの計測値）",
    "privacy.collect.item5": "エラー情報（クラッシュや例外のメッセージ等）",
    "privacy.collect.item6": "IPアドレスは保存せず、サーバー側でハッシュ化した識別値として扱う場合があります",
    "privacy.notCollect.title": "収集しない情報",
    "privacy.notCollect.item1": "パスワード",
    "privacy.notCollect.item2": "メール本文",
    "privacy.notCollect.item3": "参照画像の画像データ（ファイル内容）",
    "privacy.revoke.title": "同意の撤回",
    "privacy.revoke.text": "同意を撤回したい場合は、ブラウザのサイトデータ（localStorage / Cookie）を削除してください。その場合、次回アクセス時に再度同意の確認が表示されます。（同意がない場合はアプリを利用できません）",

    "printprep.title": "印刷用につなぎ目を補完",
    "printprep.sub.maxSide": "最大辺 {mm}mm",
    "printprep.sub.blockEdge": "1ブロック {mm}mm（最大辺 {max}mm）",
    "printprep.status.ready": "浮動するブロックはありません。",
    "printprep.status.floating": "浮動するブロックがあります（{n}パーツ）。",
    "printprep.help.ready": "このまま印刷できます。",
    "printprep.help.floating": "赤い部分が浮いています。青いブロックは自動補完（0.5サイズ）です（不要なら右クリックで削除、クリックで追加）。",
    "printprep.size": "印刷サイズ",
    "printprep.quote": "概算見積（送料別）: {yen}円 ／ 推定体積 {vol}cm³",
    "printprep.auto": "自動補完",
    "printprep.clear": "補完を消す",
    "printprep.exportStl": "書き出す（STL）",
    "printprep.request": "印刷を依頼する",
    "printprep.requestDisabled": "最大辺が180mmを超えるため、印刷依頼できません",
    "printprep.controls": "操作",
    "printprep.hint.compact.l1": "タップ: 補完(0.5)追加　長押し: 補完削除",
    "printprep.hint.compact.l2": "2本指: 移動　ピンチ: ズーム",
    "printprep.hint.compact.l3": "赤: 浮動 / 青: 補完",
    "printprep.hint.full.l1": "クリック/タップ: 補完ブロック（0.5）追加　右クリック/長押し: 補完ブロック削除",
    "printprep.hint.full.l2": "中ボタン/2本指: 移動　ホイール/ピンチ: ズーム　Space: 中央へ",
    "printprep.hint.full.l3": "赤: 浮動 / 青: 補完",
    "printprep.counts": "ブロック: {base}　補完: {supp}　浮動: {floating}",
    "printprep.counts.supportFloating": "（支柱:{n}）",
    "printprep.view.top": "上から",
    "printprep.view.bottom": "下から",
    "printprep.view.left": "左へ",
    "printprep.view.right": "右へ",
    "printprep.zoom": "ズーム",

    "print.title": "印刷を依頼する",
    "print.subtitle": "ここで連絡先と配送先を入力し、依頼を送信します（見積は概算です）。",
    "print.section.content": "内容",
    "print.done.title": "送信完了",
    "print.done.text": "印刷依頼を受け付けました。内容確認のうえ、メールでご連絡します。",
    "print.done.orderId": "注文ID",
    "print.done.backEditor": "エディターへ戻る",
    "print.done.admin": "管理画面で確認（管理者）",
    "print.done.adminNote": "※管理画面は管理者権限が必要です。",
    "print.warn.tooLarge": "⚠ 最大辺が180mmを超えています（印刷依頼には大きすぎます）",
    "print.quote.subtotal": "概算見積（小計）: {yen}円 ／ 推定体積 {vol}cm³",
    "print.quote.shippingPending": "送料は配送先入力後に自動計算します。",
    "print.quote.shippingLabel": "送料概算",
    "print.quote.totalLabel": "合計概算",
    "print.shipping.cannot": "送料が確定できませんでした（{reason}）。郵便番号検索で住所を確定し、管理者側で送料設定をご確認ください。",
    "print.note.rough": "※概算です（造形方式・材料・肉厚・充填率で変動します）",
    "print.note.ticket": "※チケット割引の反映は送信後に確定します。",
    "print.noDraft": "印刷データが見つかりません。エディターに戻って『印刷を依頼する』から進んでください。",
    "print.field.name": "お名前",
    "print.field.email": "メールアドレス",
    "print.field.phone": "電話番号（任意）",
    "print.address.title": "配送先住所（郵便番号 → 検索）",
    "print.address.zipPlaceholder": "例: 252-0802",
    "print.address.lookup": "住所検索",
    "print.address.looking": "検索中...",
    "print.address.hint": "※郵便番号検索で都道府県を確定し、送料を自動計算します。",
    "print.address.results": "検索結果",
    "print.address.line2": "住所の続き（番地・建物名など）",
    "print.address.line2Placeholder": "例: 250-4 ○○マンション101",
    "print.address.confirmed": "確定住所",
    "print.field.ticket": "優待チケット（任意）",
    "print.field.ticketPlaceholder": "例: QBU-ABCD-EFGH-IJKL",
    "print.field.ticketHint": "お持ちの場合のみ入力してください。",
    "print.field.notes": "備考（任意）",
    "print.btn.back": "戻る",
    "print.btn.submit": "依頼を送信する",
    "print.btn.submitting": "送信中...",
    "print.paymentNote": "※決済連携（Stripe/Google Pay）は次フェーズで追加予定です。",
    "print.summary.size.maxSide": "最大辺 {max}mm（1unit={unit}mm）",
    "print.summary.size.blockEdge": "1ブロック辺 {unit}mm（最大辺 {max}mm）",
    "print.summary": "モデル: {name} / ブロック数: {base}（補完 {supp}） / サイズ: {size}",
    "print.error.zip7": "郵便番号は7桁で入力してください。",
    "print.error.zipLookupFailed": "住所検索に失敗しました。",
    "print.error.zipNotFound": "該当住所が見つかりませんでした。",
    "print.error.noDraft": "印刷データがありません。エディターに戻って『印刷を依頼する』から進んでください。",
    "print.error.tooLarge": "最大辺が180mmを超えるため、印刷依頼できません。サイズを小さくしてください。",
    "print.error.email": "連絡先メールアドレスを入力してください。",
    "print.error.name": "お名前を入力してください。",
    "print.error.addressLookup": "郵便番号を入力して住所検索を行い、配送先を確定してください。",
    "print.error.addressLine2": "番地・建物名など（住所の続き）を入力してください。",
    "print.error.addressConfirm": "配送先住所を確定してください。",
    "print.error.submitFailed": "送信に失敗しました。",

    "gallery.supabaseMissing": "Supabase が未設定です。",
    "gallery.prompt.rename": "名前を変更",
    "gallery.alert.updateFailed": "更新に失敗しました: {msg}",
    "gallery.confirm.delete": "削除しますか？\n{name}",
    "gallery.alert.deleteFailed": "削除に失敗しました: {msg}",
    "gallery.alert.downloadFailed": "ダウンロードに失敗しました: {msg}",
    "gallery.alert.dataEmpty": "データが空です。",
    "gallery.prompt.legacyPassword": "（旧形式のQBUのみ）パスワードを入力してください\n※ v1.0.16以降の新規保存はパスワード無しです",
    "gallery.thumb.notReady": "スナップショットの準備ができていません。",
    "gallery.thumb.failed": "スナップショットの取得に失敗しました。",

    "account.linkCopied": "リンクをコピーしました。Chrome/Safariで貼り付けて開いてください。",
    "account.openInBrowserFailed": "Chrome/Safariなどのブラウザで開き直してからログインしてください。",

    "coding.example.mirror_x": "ミラー（X軸）",
    "coding.example.box_checker": "箱（中空）+ チェッカーペイント",
    "coding.example.sphere": "球（ソリッド）",
    "coding.snippet.picked_cube": "（クリックしたCubeは自動挿入）",
    "coding.snippet.mirror": "ミラー",
    "coding.snippet.box": "箱（Box）",
    "coding.snippet.sphere": "球（Sphere）",
    "coding.snippet.checker": "チェッカーペイント",
    "coding.support.depsSuffix": "の候補",
    "coding.support.complete": "補完候補",
    "coding.support.none": "（候補なし）",
    "coding.console.empty": "（ここに print 出力 / stderr / エラー が表示されます）",
    "coding.stats": "ブロック: {blocks} / エッジ: {edges}",
    "coding.workerNotReady": "Worker が起動していません",
    "coding.supabaseMissing": "Supabase 未設定のため、クラウドへ反映できません",

    "auth.notConfigured": "ログイン機能が未設定です。",
    "auth.googleFailed": "Googleログインに失敗しました。",

  },
  kana: {
    // こどもむけ：できるだけ わかりやすい ことば
    "mode.model": "つくる",
    "mode.paint": "いろぬり",
    "mode.coding": "ぷろぐらむ",
    "mode.gallery": "さくひん",

    "header.save": "ほぞん",
    "header.project.untitled": "なまえ なし",
    "header.project.rename": "なまえを かえる",

    "editor.blocks": "ぶろっく: {n}",
    "editor.look": "みため",
    "editor.pickColor": "いろを えらぶ",
    "editor.edges": "せん",
    "editor.preview": "ぷれびゅー",
    "editor.reset": "りせっと",
    "editor.viewFromTop": "うえから",
    "editor.viewFromBottom": "したから",
    "editor.rotateLeft": "ひだりへ",
    "editor.rotateRight": "みぎへ",
    "editor.zoomIn": "よる",
    "editor.zoomOut": "ひく",
    "editor.zoom": "ずーむ",

    "preview.front": "まえ",
    "preview.back": "うしろ",
    "preview.left": "ひだり",
    "preview.right": "みぎ",
    "preview.top": "うえ",
    "preview.bottom": "した",
    "preview.threeView": "さんめんず",
    "preview.clear": "けす",
    "preview.close": "とじる",

    "save.title": "ほぞん",
    "save.close": "とじる",
    "save.name": "なまえ",
    "save.method": "ほうほう",
    "save.method.project": "つづき",
    "save.method.project.desc": "あとで つづきから できるよ",
    "save.method.stl": "STL",
    "save.method.stl.desc": "ぷりんと よう",
    "save.destination": "ほぞん さき",
    "save.destination.hint": "じぶんの さくひん に ほぞんするよ",
    "save.destination.noteFormat": "※ v1.0.16 から あたらしい ほぞんの かたちは .qbu だけに なったよ。",
    "save.asNew": "こぴーで ほぞん",
    "save.asNew.hint": "OFFだと うわがき になるよ",
    "save.localExport": "ぱそこんに ほぞん（にんい）",
    "save.localExport.qbu": ".qbu を ほぞん",
    "save.localExport.hint": "ばっくあっぷ できるよ",
    "save.localExport.noteNoPassword": "※ かきだしに ぱすわーどは つけられないよ。",
    "save.size": "おおきさ",
    "save.size.maxSide": "ながい ほう",
    "save.size.blockEdge": "1ぶろっく",
    "save.size.mmMaxSide": "mm（ながい ほうを {mm}mm に）",
    "save.size.mmBlock": "mm（1ぶろっく）→ {mm}mm",
    "save.size.current": "いま：さいだい {n} ぶろっく ／ 1ぶろっく {mm}mm",
    "save.warn.tooLarge": "⚠ おおきすぎるよ（180mm いじょう）",
    "save.cancel": "やめる",
    "save.saving": "ほぞんちゅう...",
    "save.save": "ほぞん",
    "save.exportStl": "STL",
    "save.exportForPrint": "ぷりんと よう",

    "parent.section": "おとな せってい",
    "parent.password": "おとなの ぱすわーど",
    "parent.password.set": "せってい",
    "parent.password.change": "かえる",
    "parent.password.clear": "けす",
    "parent.password.new": "あたらしい ぱすわーど",
    "parent.password.confirm": "かくにん",
    "parent.password.saved": "できたよ",
    "parent.password.mismatch": "ちがうよ",
    "parent.remember": "しばらく OK にする",
    "parent.remember.onlyNow": "いまだけ",
    "parent.remember.minutes": "{n}ぷん",
    "parent.require": "ぱすわーどが ひつよう",
    "parent.action.print": "ぷりんと",
    "parent.action.publish": "みんなに みせる",
    "parent.action.delete": "けす",
    "parent.action.download": "だうんろーど",
    "parent.action.subscribe": "おかね",
    "parent.action.change_language": "ことばを かえる",
    "parent.prompt.enter": "おとなの ぱすわーど",
    "parent.prompt.wrong": "ちがうよ",
    "parent.prompt.failed": "うまく できなかったよ",
    "parent.state.notSet": "まだ",
    "parent.state.ok": "OK",
    "parent.state.lock": "ろっく",
    "parent.unlock": "あける",
    "parent.lock": "ろっく",
    "parent.unlockToEdit": "あけてから へんこう",

    "gallery.my": "じぶんの さくひん",
    "gallery.public": "みんなの さくひん",
    "gallery.search": "さがす",
    "gallery.loading": "よみこみちゅう...",
    "gallery.loginToSeeMy": "ろぐいん すると じぶんの さくひんが みられるよ",
    "gallery.noImage": "がぞう なし",
    "gallery.open": "ひらく",
    "gallery.openCopy": "こぴーで ひらく",
    "gallery.rename": "なまえ",
    "gallery.thumbnail": "ひょうし",
    "gallery.download": "だうんろーど",
    "gallery.publish": "みんなに みせる",
    "gallery.unpublish": "ひみつに する",
    "gallery.delete": "けす",
    "gallery.publicTag": "みんなに こうかい",
    "gallery.updated": "さいご",
    "gallery.blocks": "ぶろっく",
    "gallery.noMy": "まだ さくひんが ないよ",
    "gallery.noPublic": "みんなの さくひんが ないよ",
    "gallery.thumbHint": "みぎうえの やじるしで みえかたを かえられるよ。ぴんち/ほいーるで おおきさを かえられるよ。",
    "gallery.thumbSave": "ひょうしを ほぞん",
    "gallery.thumbPublicNote": "みんなに みせてる ときは、みんなの さくひんにも でるよ",

    "coding.code": "かく",
    "coding.current": "いま",
    "coding.preview": "けっか",
    "coding.run": "うごかす",
    "coding.apply": "つかう",
    "coding.applyBack": "つかって もどる",
    "coding.console": "こんそーる",
    "coding.resultHere": "けっかは ここに でるよ",
    "coding.running": "うごかしてる...",
    "coding.preparing": "じゅんびちゅう...",
    "coding.pyodideBoot": "じゅんびちゅう...",
    "coding.readyOk": "じゅんびOK",
    "coding.runFailed": "うごかなかったよ",
    "coding.done": "おわり（ぶろっく: {n}）",
    "coding.error": "えらー",

    "common.close": "とじる",
    "common.processing": "やってるよ...",
    "common.toEditor": "えでぃたへ",

    "account.account": "あかうんと",
    "account.signIn": "ろぐいん",
    "account.signInWithGoogle": "Google",
    "account.signOut": "ろぐあうと",
    "account.openInBrowser": "ぶらうざで ひらく",
    "account.loginRequired": "ろぐいんが ひつようだよ",
    "account.notConfigured": "ろぐいん できない（せってい なし）",
    "account.docs": "つかいかた",
    "account.docs.all": "もくじ",
    "account.docs.modeling": "つくる",
    "account.docs.painting": "いろぬり",
    "account.docs.coding": "ぷろぐらむ",
    "account.docs.gallery": "さくひん",
    "account.settings": "せってい",
    "account.language": "ことば",
    "account.close": "とじる",

    "toast.renamed": "なまえを かえたよ: {name}",
    "toast.renameFailed": "なまえを かえられなかったよ: {msg}",
    "toast.loginToSyncName": "ろぐいん すると くらうどに ほぞんできるよ",

    "common.on": "ON",
    "common.off": "OFF",

    "consent.aria": "つかいかたの きろく",
    "consent.title": "つかいかたの きろく（ひつよう）",
    "consent.required": "どういが ひつようだよ",
    "consent.text": "Q-BU! は もっと よくするために、つかった きろく（そうさの ろぐ）を あつめるよ。",
    "consent.collect": "あつめる：へんしゅう/ぷれびゅー、ずーむ、ぼたん、ほぞん、えらー、きき/ぶらうざの じょうほう（がめんの おおきさ など）",
    "consent.notCollect": "あつめない：めーるの ほんぶん、ぱすわーど、がぞうそのもの（ふぁいるの なかみ）",
    "consent.detail": "くわしく みる",
    "consent.agree": "どういして はじめる",

    "privacy.title": "ぷらいばしー と きろく",
    "privacy.back": "もどる",
    "privacy.agreeStart": "どういして はじめる",
    "privacy.intro": "Q-BU! は もっと たのしくするために、つかいかたの きろく（そうさの ろぐ）を とるよ。つかうには どういが ひつようだよ。",
    "privacy.collect.title": "あつめる じょうほう",
    "privacy.collect.item1": "そうさ（へんしゅう/ぷれびゅー、ずーむ、ぼたん、ほぞん など）",
    "privacy.collect.item2": "いまの じょうたい（ぶろっくの かず、みている むき、ずーむ など）",
    "privacy.collect.item3": "きき/ぶらうざの じょうほう（がめんの おおきさ、ことば、たいむぞーん など）",
    "privacy.collect.item4": "はやさの きろく（ひょうじ じかん など）",
    "privacy.collect.item5": "えらーの じょうほう",
    "privacy.collect.item6": "IPあどれすは そのまま ほぞんしないで、はっしゅに することがあるよ",
    "privacy.notCollect.title": "あつめない じょうほう",
    "privacy.notCollect.item1": "ぱすわーど",
    "privacy.notCollect.item2": "めーるの ほんぶん",
    "privacy.notCollect.item3": "さんしょうがぞうの なかみ（ふぁいる）",
    "privacy.revoke.title": "どういを やめたい",
    "privacy.revoke.text": "ぶらうざの さいとでーた（localStorage / Cookie）を けすと、つぎは もういちど かくにんが でるよ。（どういが ないと つかえないよ）",

    "printprep.title": "ぷりんと の じゅんび",
    "printprep.sub.maxSide": "ながい へん {mm}mm",
    "printprep.sub.blockEdge": "1ぶろっく {mm}mm（ながい へん {max}mm）",
    "printprep.status.ready": "ういてる ぶろっくは ないよ。",
    "printprep.status.floating": "ういてる ぶろっくが あるよ（{n}ぱーつ）。",
    "printprep.help.ready": "このまま ぷりんと できるよ。",
    "printprep.help.floating": "あかは ういてるよ。あおは つなぎ（0.5）だよ。たっぷで ついか、ながおしで けせるよ。",
    "printprep.size": "おおきさ",
    "printprep.quote": "だいたい: {yen}えん（そうりょうべつ） / たいせき {vol}cm³",
    "printprep.auto": "じどうで つなぐ",
    "printprep.clear": "つなぎを けす",
    "printprep.exportStl": "STLを だす",
    "printprep.request": "ぷりんとを たのむ",
    "printprep.requestDisabled": "おおきすぎて たのめないよ",
    "printprep.controls": "そうさ",
    "printprep.hint.compact.l1": "たっぷ: つなぎ(0.5)ついか / ながおし: けす",
    "printprep.hint.compact.l2": "2ほんゆび: うごかす / ぴんち: ずーむ",
    "printprep.hint.compact.l3": "あか: ういてる / あお: つなぎ",
    "printprep.hint.full.l1": "くりっく/たっぷ: つなぎ(0.5)ついか / みぎくりっく/ながおし: けす",
    "printprep.hint.full.l2": "ちゅうぼたん/2ほんゆび: うごかす / ほいーる/ぴんち: ずーむ / Space: まんなか",
    "printprep.hint.full.l3": "あか: ういてる / あお: つなぎ",
    "printprep.counts": "ぶろっく: {base}　つなぎ: {supp}　うき: {floating}",
    "printprep.counts.supportFloating": "（しちゅう:{n}）",
    "printprep.view.top": "うえから",
    "printprep.view.bottom": "したから",
    "printprep.view.left": "ひだりへ",
    "printprep.view.right": "みぎへ",
    "printprep.zoom": "ずーむ",

    "gallery.supabaseMissing": "せっていが たりないよ（Supabase）",
    "gallery.prompt.rename": "なまえを かえる",
    "gallery.alert.updateFailed": "うまく できなかったよ: {msg}",
    "gallery.confirm.delete": "けす？\n{name}",
    "gallery.alert.deleteFailed": "けせなかったよ: {msg}",
    "gallery.alert.downloadFailed": "だうんろーど できなかったよ: {msg}",
    "gallery.alert.dataEmpty": "でーたが ないよ。",
    "gallery.prompt.legacyPassword": "（むかしのQBUだけ）ぱすわーどを いれてね\n※ あたらしい ほぞんは いらないよ",
    "gallery.thumb.notReady": "ひょうしの じゅんびが できてないよ。",
    "gallery.thumb.failed": "ひょうしが うまく とれなかったよ。",

    "account.linkCopied": "りんくを こぴーしたよ。Chrome/Safariに はって ひらいてね。",
    "account.openInBrowserFailed": "Chrome/Safariで ひらきなおして から ろぐいんしてね。",

    "coding.example.mirror_x": "みらー（Xじく）",
    "coding.example.box_checker": "はこ + しましま ぺいんと",
    "coding.example.sphere": "たま（そりっど）",
    "coding.snippet.picked_cube": "（くりっくしたCubeは じどうで はいるよ）",
    "coding.snippet.mirror": "みらー",
    "coding.snippet.box": "はこ",
    "coding.snippet.sphere": "たま",
    "coding.snippet.checker": "しましま ぺいんと",
    "coding.support.depsSuffix": "の こうほ",
    "coding.support.complete": "こうほ",
    "coding.support.none": "（ないよ）",
    "coding.console.empty": "（ここに けっかが でるよ）",
    "coding.stats": "ぶろっく: {blocks} / えっじ: {edges}",
    "coding.workerNotReady": "うごくところが まだ ないよ",
    "coding.supabaseMissing": "せっていが たりないから ほぞんできないよ",

    "auth.notConfigured": "ろぐいん できない（せってい なし）",
    "auth.googleFailed": "Googleろぐいんが うまく いかなかったよ",

  },
};

export function translate(lang: Lang, key: string, vars?: Record<string, string | number>): string {
  const dict = MESSAGES[lang] || MESSAGES.ja;
  let out = dict[key] ?? MESSAGES.ja[key] ?? key;
  if (vars) {
    for (const [k, v] of Object.entries(vars)) {
      out = out.replaceAll(`{${k}}`, String(v));
    }
  }
  return out;
}
